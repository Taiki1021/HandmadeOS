#include"defs.h"


int main(){
//PICの初期化
	//マスター
	outb(0x20,0x11);
	outb(0x21,0x20);
	outb(0x21,0x04);
	outb(0x21,0x01);
	outb(0x21,0xFB^0x03);
	//スレーブ
	outb(0xA0,0x11);
	outb(0xA1,0x28);
	outb(0xA1,0x02);
	outb(0xA1,0x01);
	outb(0xA1,0xFF^0x00);

//A20ゲートオン
	while(inb(0x64)&2);
	outb(0x64,0xd1);
	while(inb(0x64)&2);
	outb(0x60,0xdf);
	while(inb(0x64)&2);

//GDTの初期化
	GDT_Init();

//IDTの初期化
	IDT_Init();

//各種サブシステム初期化
	clear();
	mem_reset();
	KBD_Init();
	Proc_Init();
	sti();
	
//システム起動
	IdleProcess();
}
